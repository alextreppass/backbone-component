<!DOCTYPE html>

<html>
<head>
  <title>Backbone.Component</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>Backbone.Component</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
<p>A thin layer on top of Backbone&#39;s view class to add nested child views.</p>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              

            </div>
            
            <div class="content"><div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">Component</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              
<p>Override constructor so Components can use initialise as normal.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_children</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wrapRender</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wrapRemove</span><span class="p">();</span>

    <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
<h2>Public API</h2>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              
<hr>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              
<p>Add a child view to the end of the element.
Optionally specify a selector within the view to attach to.
Aliased to <code>add</code>.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">append</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_addChild</span><span class="p">(</span><span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="s1">&#39;append&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
<p>Add a child view to the beginning of the view&#39;s element.
Optionally specify a selector within the view to attach to.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">prepend</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_addChild</span><span class="p">(</span><span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="s1">&#39;prepend&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              
<h2>Private methods</h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              
<hr>

            </div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              
<p>Add a child view to an internal array keeping a reference to
element and attach method it should use.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_addChild</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">view</span><span class="o">:</span> <span class="nx">view</span><span class="p">,</span> <span class="nx">selector</span><span class="o">:</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">method</span><span class="o">:</span> <span class="nx">method</span> <span class="p">};</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              
<p>Assign a method to the child so it can remove itself from
<code>_children</code> array when it&#39;s removed.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">removeFromParent</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_removeFromParent</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="nx">view</span><span class="p">.</span><span class="nx">_removeFromParent</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">removeFromParent</span><span class="p">,</span> <span class="nx">child</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              
<p>Call remove for each child added to the view.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_removeChildren</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">),</span> <span class="s1">&#39;remove&#39;</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">_removeFromParent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_children</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">without</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">,</span> <span class="nx">child</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              
<p>Wrap render to automatically attach all children.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_wrapRender</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">render</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="nx">render</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_attachChildren</span><span class="p">();</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">originalRender</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">originalRender</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              
<p>Wrap remove to automatically remove all children and itself from 
its parent.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_wrapRemove</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">remove</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_removeFromParent</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_removeChildren</span><span class="p">();</span>
      <span class="nx">remove</span><span class="p">();</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">originalRemove</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">originalRemove</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              
<p>Attach child to the correct element and with correct method.
Defaults to <code>this.$el</code> and <code>append</code>.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_attachChild</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">child</span><span class="p">.</span><span class="nx">method</span> <span class="o">||</span> <span class="s1">&#39;append&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">child</span><span class="p">.</span><span class="nx">selector</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">;</span>

    <span class="nx">child</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    <span class="nx">target</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">child</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
  <span class="p">},</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              
<p>Attach all children in the right order.
Call <code>delegateEvents</code> for each child view so handlers are correctly
bound after being attached.</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>  <span class="nx">_attachChildren</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_children</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_attachChild</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>
      <span class="nx">child</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">delegateEvents</span><span class="p">();</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
